{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/blood/Documents/School/4A/PST/PST4A/MUSIARK/pst-4a-MusIA/app/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/blood/Documents/School/4A/PST/PST4A/MUSIARK/pst-4a-MusIA/app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/blood/Documents/School/4A/PST/PST4A/MUSIARK/pst-4a-MusIA/app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import'../styles/Content.css';import{useState,useEffect}from'react';import Listening from'./Listening';import Home from'./Home';import Url from'./UrlComponent';import{jsx as _jsx}from\"react/jsx-runtime\";function Content(_ref){var isContent=_ref.isContent,setIsContent=_ref.setIsContent;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isReceiving=_useState2[0],setIsReceiving=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isListening=_useState4[0],setIsListening=_useState4[1];// LISTENING TO THE MICROPHONE\nfunction renderSwitch(param){switch(param){case 0:return/*#__PURE__*/_jsx(Home,{setIsContent:setIsContent,isListening:isListening,setIsListening:setIsListening,isReceiving:isReceiving,setIsReceiving:setIsReceiving});case 1:return/*#__PURE__*/_jsx(Url,{isContent:isContent,setIsContent:setIsContent,isReceiving:isReceiving,setIsReceiving:setIsReceiving});case 2:return/*#__PURE__*/_jsx(Listening,{setIsContent:setIsContent,isReceiving:isReceiving,setIsReceiving:setIsReceiving,setIsListening:setIsListening});default:return/*#__PURE__*/_jsx(\"div\",{});}}useEffect(function(){if(isListening===true){var constraints={audio:true};var chunks=[];navigator.mediaDevices.getUserMedia(constraints).then(function(stream){var recorder=new MediaRecorder(stream);recorder.ondataavailable=function(event){chunks.push(event.data);var blob=new Blob(chunks,{type:\"audio/wav\"});var xmlhttp=new XMLHttpRequest();var url=\"http://127.0.0.1:5000/api/v01/post/audio-blob/\";xmlhttp.open(\"POST\",url,true);xmlhttp.setRequestHeader(\"Content-type\",\"audio/wav\");xmlhttp.send(blob);};var sleep=function sleep(time){return new Promise(function(resolve){return setTimeout(resolve,time);});};_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:recorder.start(21000);_context.next=3;return sleep(22000);case 3:_context.next=5;return recorder.stop();case 5:setIsListening(false);setIsReceiving(true);case 7:case\"end\":return _context.stop();}},_callee);}))();}).catch(function(err){/* handle the error */});}},[isListening]);return/*#__PURE__*/_jsx(\"div\",{className:\"Content\",children:renderSwitch(isContent)});}export default Content;","map":{"version":3,"names":["useState","useEffect","Listening","Home","Url","Content","isContent","setIsContent","isReceiving","setIsReceiving","isListening","setIsListening","renderSwitch","param","constraints","audio","chunks","navigator","mediaDevices","getUserMedia","then","stream","recorder","MediaRecorder","ondataavailable","event","push","data","blob","Blob","type","xmlhttp","XMLHttpRequest","url","open","setRequestHeader","send","sleep","time","Promise","resolve","setTimeout","start","stop","catch","err"],"sources":["C:/Users/blood/Documents/School/4A/PST/PST4A/MUSIARK/pst-4a-MusIA/app/src/Components/Content.js"],"sourcesContent":["import '../styles/Content.css';\r\nimport { useState,useEffect } from 'react'\r\nimport Listening from './Listening';\r\nimport Home from './Home';\r\nimport Url from './UrlComponent'\r\n\r\n\r\nfunction Content({isContent,setIsContent}) {\r\n  \r\n  const [isReceiving, setIsReceiving] = useState(false)\r\n  const [isListening, setIsListening] = useState(false)\r\n\r\n\r\n  // LISTENING TO THE MICROPHONE\r\n  function renderSwitch(param) {\r\n    switch(param) {\r\n      case 0:\r\n        return <Home setIsContent={setIsContent} isListening={isListening} setIsListening={setIsListening} isReceiving={isReceiving} setIsReceiving={setIsReceiving}/>;\r\n      case 1:\r\n        return <Url isContent={isContent} setIsContent={setIsContent} isReceiving={isReceiving} setIsReceiving={setIsReceiving}/>;\r\n      case 2:\r\n        return <Listening setIsContent={setIsContent} isReceiving={isReceiving} setIsReceiving={setIsReceiving} setIsListening={setIsListening}/>;\r\n      default:\r\n        return  <div>\r\n                </div>;\r\n    }\r\n  }\r\n \r\n    \r\n    useEffect(() => {\r\n      if(isListening === true){\r\n        var constraints = { audio: true }\r\n      var chunks = []\r\n      navigator.mediaDevices.getUserMedia(constraints)\r\n      .then(function(stream) {\r\n          const recorder = new MediaRecorder(stream);\r\n          recorder.ondataavailable = event => {\r\n              chunks.push(event.data);\r\n              var blob = new Blob(chunks, {\r\n                  type: \"audio/wav\"\r\n              });\r\n              var xmlhttp = new XMLHttpRequest();\r\n              var url = \"http://127.0.0.1:5000/api/v01/post/audio-blob/\";\r\n              xmlhttp.open(\"POST\", url, true);\r\n              xmlhttp.setRequestHeader(\"Content-type\", \"audio/wav\");\r\n              xmlhttp.send(blob);\r\n          };\r\n          \r\n          const sleep = time => new Promise(resolve => setTimeout(resolve, time));\r\n  \r\n        (async () => {\r\n          \r\n          recorder.start(21000);\r\n          await sleep(22000);\r\n          await recorder.stop();\r\n          setIsListening(false);\r\n          setIsReceiving(true);\r\n      })();\r\n      })\r\n      .catch(function(err) {\r\n          /* handle the error */\r\n      });\r\n\r\n      }\r\n      \r\n  }, [isListening]);\r\n\r\n    \r\n\r\n  return(\r\n    <div className=\"Content\">\r\n      {renderSwitch(isContent)}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Content;\r\n"],"mappings":"ieAAA,MAAO,uBAAuB,CAC9B,OAASA,QAAQ,CAACC,SAAS,KAAQ,OAAO,CAC1C,MAAOC,UAAS,KAAM,aAAa,CACnC,MAAOC,KAAI,KAAM,QAAQ,CACzB,MAAOC,IAAG,KAAM,gBAAgB,4CAGhC,QAASC,QAAO,MAA2B,IAAzBC,UAAS,MAATA,SAAS,CAACC,YAAY,MAAZA,YAAY,CAEtC,cAAsCP,QAAQ,CAAC,KAAK,CAAC,wCAA9CQ,WAAW,eAAEC,cAAc,eAClC,eAAsCT,QAAQ,CAAC,KAAK,CAAC,yCAA9CU,WAAW,eAAEC,cAAc,eAGlC;AACA,QAASC,aAAY,CAACC,KAAK,CAAE,CAC3B,OAAOA,KAAK,EACV,IAAK,EAAC,CACJ,mBAAO,KAAC,IAAI,EAAC,YAAY,CAAEN,YAAa,CAAC,WAAW,CAAEG,WAAY,CAAC,cAAc,CAAEC,cAAe,CAAC,WAAW,CAAEH,WAAY,CAAC,cAAc,CAAEC,cAAe,EAAE,CAChK,IAAK,EAAC,CACJ,mBAAO,KAAC,GAAG,EAAC,SAAS,CAAEH,SAAU,CAAC,YAAY,CAAEC,YAAa,CAAC,WAAW,CAAEC,WAAY,CAAC,cAAc,CAAEC,cAAe,EAAE,CAC3H,IAAK,EAAC,CACJ,mBAAO,KAAC,SAAS,EAAC,YAAY,CAAEF,YAAa,CAAC,WAAW,CAAEC,WAAY,CAAC,cAAc,CAAEC,cAAe,CAAC,cAAc,CAAEE,cAAe,EAAE,CAC3I,QACE,mBAAQ,cACM,CAAC,CAErB,CAGEV,SAAS,CAAC,UAAM,CACd,GAAGS,WAAW,GAAK,IAAI,CAAC,CACtB,GAAII,YAAW,CAAG,CAAEC,KAAK,CAAE,IAAK,CAAC,CACnC,GAAIC,OAAM,CAAG,EAAE,CACfC,SAAS,CAACC,YAAY,CAACC,YAAY,CAACL,WAAW,CAAC,CAC/CM,IAAI,CAAC,SAASC,MAAM,CAAE,CACnB,GAAMC,SAAQ,CAAG,GAAIC,cAAa,CAACF,MAAM,CAAC,CAC1CC,QAAQ,CAACE,eAAe,CAAG,SAAAC,KAAK,CAAI,CAChCT,MAAM,CAACU,IAAI,CAACD,KAAK,CAACE,IAAI,CAAC,CACvB,GAAIC,KAAI,CAAG,GAAIC,KAAI,CAACb,MAAM,CAAE,CACxBc,IAAI,CAAE,WACV,CAAC,CAAC,CACF,GAAIC,QAAO,CAAG,GAAIC,eAAc,EAAE,CAClC,GAAIC,IAAG,CAAG,gDAAgD,CAC1DF,OAAO,CAACG,IAAI,CAAC,MAAM,CAAED,GAAG,CAAE,IAAI,CAAC,CAC/BF,OAAO,CAACI,gBAAgB,CAAC,cAAc,CAAE,WAAW,CAAC,CACrDJ,OAAO,CAACK,IAAI,CAACR,IAAI,CAAC,CACtB,CAAC,CAED,GAAMS,MAAK,CAAG,QAARA,MAAK,CAAGC,IAAI,QAAI,IAAIC,QAAO,CAAC,SAAAC,OAAO,QAAIC,WAAU,CAACD,OAAO,CAAEF,IAAI,CAAC,GAAC,GAEzE,0DAAC,oIAEChB,QAAQ,CAACoB,KAAK,CAAC,KAAK,CAAC,CAAC,sBAChBL,MAAK,CAAC,KAAK,CAAC,8BACZf,SAAQ,CAACqB,IAAI,EAAE,QACrBhC,cAAc,CAAC,KAAK,CAAC,CACrBF,cAAc,CAAC,IAAI,CAAC,CAAC,qDACxB,IAAG,CACJ,CAAC,CAAC,CACDmC,KAAK,CAAC,SAASC,GAAG,CAAE,CACjB,uBACH,CAAC,CAEF,CAEJ,CAAC,CAAE,CAACnC,WAAW,CAAC,CAAC,CAIjB,mBACE,YAAK,SAAS,CAAC,SAAS,UACrBE,YAAY,CAACN,SAAS,CAAC,EACpB,CAEV,CAEA,cAAeD,QAAO"},"metadata":{},"sourceType":"module","externalDependencies":[]}
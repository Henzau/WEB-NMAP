{"ast":null,"code":"import _slicedToArray from\"C:/Users/blood/Documents/School/4A/PST/PST4A/MUSIARK/pst-4a-MusIA/app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import MusiaLogotransparent from'../assets/logo_trans.png';import'../styles/Content.css';import{useState,useEffect}from'react';import Prediction from'./Prediction';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function Listening(_ref){var selectedModel=_ref.selectedModel,id=_ref.id,setIsContent=_ref.setIsContent,isReceiving=_ref.isReceiving,setIsReceiving=_ref.setIsReceiving,setIsListening=_ref.setIsListening;var _useState=useState({}),_useState2=_slicedToArray(_useState,2),data=_useState2[0],setdata=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isDisplay=_useState4[0],setIsDisplay=_useState4[1];useEffect(function(){if(isReceiving&&!isDisplay&&id.length>1){// check if id is not undefined or null\nfetch(\"https://6990-90-104-195-37.eu.ngrok.io/api/v01/get/res/?id=\"+id+\"&model=\"+selectedModel,{method:\"get\",headers:new Headers({\"ngrok-skip-browser-warning\":\"69420\"})}).then(function(response){return response.json();// <<- Return the JSON Object\n}).then(function(result){if(result[1]===-1){alert(\"La musique n'a pas été reconnue, essayons par URL\");setIsReceiving(false);setIsListening(false);setIsContent(1);}else{setdata(result);setIsDisplay(true);}}).catch(function(error){console.error(error);var errorMessage='Something went wrong';console.log(errorMessage);setIsListening(0);setIsReceiving(0);setIsContent(0);});}},[selectedModel,isReceiving,isDisplay,id,setIsContent,setIsListening,setIsReceiving]);return isReceiving?/*#__PURE__*/_jsx(Prediction,{selectedModel:selectedModel,isDisplay:isDisplay,setIsDisplay:setIsDisplay,data:data}):/*#__PURE__*/_jsxs(\"div\",{className:\"ContentListening\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"transbutton\",alt:\"Listening\",children:/*#__PURE__*/_jsx(\"img\",{src:MusiaLogotransparent,className:\"App-logo\",alt:\"Logo\"})}),/*#__PURE__*/_jsx(\"p\",{children:\"L'application est en \\xE9coute, veuillez patienter.\"})]});}export default Listening;","map":{"version":3,"names":["MusiaLogotransparent","useState","useEffect","Prediction","Listening","selectedModel","id","setIsContent","isReceiving","setIsReceiving","setIsListening","data","setdata","isDisplay","setIsDisplay","length","fetch","method","headers","Headers","then","response","json","result","alert","catch","error","console","errorMessage","log"],"sources":["C:/Users/blood/Documents/School/4A/PST/PST4A/MUSIARK/pst-4a-MusIA/app/src/Components/Listening.js"],"sourcesContent":["import MusiaLogotransparent from '../assets/logo_trans.png'\r\nimport '../styles/Content.css';\r\n\r\nimport { useState, useEffect } from 'react'\r\nimport Prediction from './Prediction';\r\n\r\nfunction Listening({selectedModel,id,setIsContent,isReceiving,setIsReceiving,setIsListening}) {\r\n  \r\n  const [data, setdata] = useState({});\r\n  const [isDisplay, setIsDisplay] = useState(false);\r\n\r\n \r\n  useEffect(() => {\r\n    if (isReceiving && !isDisplay && id.length > 1) { // check if id is not undefined or null\r\n      \r\n      fetch(`https://6990-90-104-195-37.eu.ngrok.io/api/v01/get/res/?id=`+id+\"&model=\"+selectedModel, {\r\n        method: \"get\",\r\n        headers: new Headers({\r\n          \"ngrok-skip-browser-warning\": \"69420\",\r\n        }),\r\n      })\r\n      .then(response => {\r\n        return response.json(); // <<- Return the JSON Object\r\n      })\r\n      .then(result => {\r\n        if (result[1] === -1) {\r\n          alert(\"La musique n'a pas été reconnue, essayons par URL\");\r\n          setIsReceiving(false);\r\n          setIsListening(false);\r\n          setIsContent(1);\r\n        } else {\r\n          setdata(result);\r\n          setIsDisplay(true);\r\n        }\r\n      })\r\n      .catch(error => { \r\n        console.error(error);\r\n        const errorMessage = 'Something went wrong';\r\n        console.log(errorMessage);\r\n        setIsListening(0);\r\n        setIsReceiving(0);\r\n        setIsContent(0);\r\n      });\r\n    }\r\n  }, [selectedModel,isReceiving, isDisplay, id, setIsContent, setIsListening, setIsReceiving]);\r\n  \r\n  \r\n  return isReceiving ? (\r\n    <Prediction selectedModel={selectedModel} isDisplay={isDisplay} setIsDisplay={setIsDisplay} data={data} />\r\n  )  :  (\r\n    <div className=\"ContentListening\">\r\n        <button className=\"transbutton\" alt=\"Listening\" ><img src={MusiaLogotransparent} className=\"App-logo\" alt=\"Logo\" /></button>\r\n        <p>\r\n          L'application est en écoute, veuillez patienter.\r\n        </p>\r\n    </div>\r\n  );\r\n} \r\n\r\nexport default Listening;\r\n"],"mappings":"2JAAA,MAAOA,qBAAoB,KAAM,0BAA0B,CAC3D,MAAO,uBAAuB,CAE9B,OAASC,QAAQ,CAAEC,SAAS,KAAQ,OAAO,CAC3C,MAAOC,WAAU,KAAM,cAAc,CAAC,wFAEtC,QAASC,UAAS,MAA4E,IAA1EC,cAAa,MAAbA,aAAa,CAACC,EAAE,MAAFA,EAAE,CAACC,YAAY,MAAZA,YAAY,CAACC,WAAW,MAAXA,WAAW,CAACC,cAAc,MAAdA,cAAc,CAACC,cAAc,MAAdA,cAAc,CAEzF,cAAwBT,QAAQ,CAAC,CAAC,CAAC,CAAC,wCAA7BU,IAAI,eAAEC,OAAO,eACpB,eAAkCX,QAAQ,CAAC,KAAK,CAAC,yCAA1CY,SAAS,eAAEC,YAAY,eAG9BZ,SAAS,CAAC,UAAM,CACd,GAAIM,WAAW,EAAI,CAACK,SAAS,EAAIP,EAAE,CAACS,MAAM,CAAG,CAAC,CAAE,CAAE;AAEhDC,KAAK,CAAC,8DAA8DV,EAAE,CAAC,SAAS,CAACD,aAAa,CAAE,CAC9FY,MAAM,CAAE,KAAK,CACbC,OAAO,CAAE,GAAIC,QAAO,CAAC,CACnB,4BAA4B,CAAE,OAChC,CAAC,CACH,CAAC,CAAC,CACDC,IAAI,CAAC,SAAAC,QAAQ,CAAI,CAChB,MAAOA,SAAQ,CAACC,IAAI,EAAE,CAAE;AAC1B,CAAC,CAAC,CACDF,IAAI,CAAC,SAAAG,MAAM,CAAI,CACd,GAAIA,MAAM,CAAC,CAAC,CAAC,GAAK,CAAC,CAAC,CAAE,CACpBC,KAAK,CAAC,mDAAmD,CAAC,CAC1Df,cAAc,CAAC,KAAK,CAAC,CACrBC,cAAc,CAAC,KAAK,CAAC,CACrBH,YAAY,CAAC,CAAC,CAAC,CACjB,CAAC,IAAM,CACLK,OAAO,CAACW,MAAM,CAAC,CACfT,YAAY,CAAC,IAAI,CAAC,CACpB,CACF,CAAC,CAAC,CACDW,KAAK,CAAC,SAAAC,KAAK,CAAI,CACdC,OAAO,CAACD,KAAK,CAACA,KAAK,CAAC,CACpB,GAAME,aAAY,CAAG,sBAAsB,CAC3CD,OAAO,CAACE,GAAG,CAACD,YAAY,CAAC,CACzBlB,cAAc,CAAC,CAAC,CAAC,CACjBD,cAAc,CAAC,CAAC,CAAC,CACjBF,YAAY,CAAC,CAAC,CAAC,CACjB,CAAC,CAAC,CACJ,CACF,CAAC,CAAE,CAACF,aAAa,CAACG,WAAW,CAAEK,SAAS,CAAEP,EAAE,CAAEC,YAAY,CAAEG,cAAc,CAAED,cAAc,CAAC,CAAC,CAG5F,MAAOD,YAAW,cAChB,KAAC,UAAU,EAAC,aAAa,CAAEH,aAAc,CAAC,SAAS,CAAEQ,SAAU,CAAC,YAAY,CAAEC,YAAa,CAAC,IAAI,CAAEH,IAAK,EAAG,cAE1G,aAAK,SAAS,CAAC,kBAAkB,wBAC7B,eAAQ,SAAS,CAAC,aAAa,CAAC,GAAG,CAAC,WAAW,uBAAE,YAAK,GAAG,CAAEX,oBAAqB,CAAC,SAAS,CAAC,UAAU,CAAC,GAAG,CAAC,MAAM,EAAG,EAAS,cAC5H,mBAAG,qDAEH,EAAI,GAET,CACH,CAEA,cAAeI,UAAS"},"metadata":{},"sourceType":"module","externalDependencies":[]}